/*
 * Toast Popup Library 사용법
 *
 * 간단한 토스트 팝업 라이브러리입니다. 프레임워크 없이 순수 JS/CSS로 동작하며 info, alert, confirm 기능을 제공합니다.
 *
 * 포함 파일:
 * - src/toast.css
 * - src/toast.js
 *
 * HTML에 추가:
 * <link rel="stylesheet" href="src/toast.css" />
 * <script src="src/toast.js"></script>
 *
 * 기본 API:
 * - Toast.info(message, options)
 * - Toast.alert(message, options)
 * - Toast.confirm(message, onConfirm, onCancel, options)
 * - Toast.setDefaults(options)
 * - Toast.clear([position])
 *
 * 옵션:
 * - title: 제목
 * - position: 위치 (top-right, top-left, bottom-right, bottom-left, top-center, bottom-center)
 * - duration: 자동 닫힘 시간 (ms)
 * - dismissible: 닫기 버튼 표시
 * - maxVisible: 최대 표시 개수
 *
 * 예시:
 * Toast.info('작업이 완료되었습니다.', { duration: 3000 });
 * Toast.alert('저장에 실패했습니다.', { title: '경고', position: 'bottom-left' });
 * Toast.confirm('삭제하시겠습니까?', () => Toast.info('삭제됨'), () => Toast.info('취소됨'), { position: 'top-center' });
 */
(function(){function t(t){const e=s[t]?t:a.position;if(r.containers.has(e))return r.containers.get(e);const n=document.createElement("div");return n.className=`tp-container ${s[e]}`,n.dataset.position=e,document.body.appendChild(n),r.containers.set(e,n),n}function e(t,e){const n=Array.from(t.children);if(n.length<=e)return;const i=n.length-e,a=(t.dataset.position||"").includes("bottom");if(a)for(let t=0;t<i;t++)o(n[t]);else for(let t=0;t<i;t++)o(n[n.length-1-t])}function n(t,e,n){const o=document.createElement("button");return o.type="button",o.className=`tp-btn ${e||""}`.trim(),o.textContent=t,"function"==typeof n&&o.addEventListener("click",n),o}function o(t){if(!t||t.__hiding)return;t.__hiding=!0,t.classList.add("tp-hide");const e=()=>t.remove();t.addEventListener("animationend",e,{once:!0}),setTimeout(e,400)}function i({type:i,title:a,message:s,options:c}){function l(){"confirm"===i||m||p.duration&&p.duration>0&&(b=setTimeout(()=>o(f),p.duration))}function d(){b&&(clearTimeout(b),b=null)}const p={...r.defaults,...c||{}},m=0===p.duration||!1===p.duration,u=t(p.position),f=document.createElement("div");if(f.className=`tp-toast tp-${i}`,f.setAttribute("role","alert"===i?"alert":"confirm"===i?"alertdialog":"status"),f.setAttribute("aria-live",p.ariaLive),f.tabIndex=-1,a){const t=document.createElement("div");t.className="tp-title",t.textContent=a,f.appendChild(t)}else{const t=document.createElement("div");t.className="tp-title",t.style.display="none",f.appendChild(t)}const h=document.createElement("div");if(h.className="tp-message","string"==typeof s?h.textContent=s:s instanceof Node&&h.appendChild(s),f.appendChild(h),(p.dismissible||m)&&"confirm"!==i){const t=document.createElement("button");t.className="tp-close",t.setAttribute("aria-label","닫기"),t.innerHTML="✕",t.addEventListener("click",()=>o(f)),f.appendChild(t)}const y=document.createElement("div");y.className="tp-actions";let b=null,C=!1;if(f.addEventListener("mouseenter",d),f.addEventListener("mouseleave",l),"confirm"===i){const t=p.okText||"확인",e=p.cancelText||"취소",i=()=>{C||(C=!0,"function"==typeof p.onConfirm&&p.onConfirm(),o(f))},a=()=>{C||(C=!0,"function"==typeof p.onCancel&&p.onCancel(),o(f))};y.appendChild(n(e,"secondary",a)),y.appendChild(n(t,"primary",i)),f.addEventListener("keydown",t=>{"Escape"===t.key&&(t.stopPropagation(),a()),"Enter"===t.key&&(t.stopPropagation(),i())}),p.duration&&p.duration>0&&(b=setTimeout(()=>{C||a()},p.duration))}else Array.isArray(p.actions)&&p.actions.slice(0,3).forEach((t,e)=>{const i=n(t.label||`Action ${e+1}`,t.className||"secondary",e=>{try{t.onClick&&t.onClick(e)}finally{o(f)}});y.appendChild(i)});y.childElementCount>0&&f.appendChild(y);const g=(u.dataset.position||"").includes("bottom");return g?u.appendChild(f):u.prepend(f),e(u,p.maxVisible),("confirm"===i||p.focus)&&setTimeout(()=>{try{f.focus()}catch{}},0),l(),{element:f,close:()=>o(f)}}const a={position:"top-right",duration:4e3,dismissible:!0,maxVisible:5,ariaLive:"polite"},s={"top-right":"tp-top-right","top-left":"tp-top-left","bottom-right":"tp-bottom-right","bottom-left":"tp-bottom-left","top-center":"tp-top-center","bottom-center":"tp-bottom-center"},r={defaults:{...a},containers:new Map},c={setDefaults(t){r.defaults={...r.defaults,...t||{}}},clear(t){if(t){const e=r.containers.get(t);e&&Array.from(e.children).forEach(o)}else r.containers.forEach(t=>Array.from(t.children).forEach(o))},info(t,e={}){const{title:n="정보",...o}=e;return i({type:"info",title:n,message:t,options:o})},alert(t,e={}){const{title:n="알림",...o}=e;return o.ariaLive=o.ariaLive||"assertive",i({type:"alert",title:n,message:t,options:o})},confirm(t,e,n,o={}){const{title:a="확인",...s}=o;return s.onConfirm=e,s.onCancel=n,i({type:"confirm",title:a,message:t,options:s})}};"undefined"!=typeof window&&(window.Toast=c)})();